2022-06-11 12:45:26.217311: I tensorflow/core/tpu/tpu_api_dlsym_initializer.cc:116] Libtpu path is: libtpu.so
Missing key: 'TWIST' in 'tpu-env' (yaml) instance metadata.
2022-06-11 12:45:27.844095: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-06-11 12:45:31.336081: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x5b2d980 initialized for platform TPU (this does not guarantee that XLA will be used). Devices:
2022-06-11 12:45:31.336134: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): TPU, 2a886c8
2022-06-11 12:45:31.336144: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (1): TPU, 2a886c8
2022-06-11 12:45:31.336151: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (2): TPU, 2a886c8
2022-06-11 12:45:31.336157: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (3): TPU, 2a886c8
2022-06-11 12:45:31.336164: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (4): TPU, 2a886c8
2022-06-11 12:45:31.336170: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (5): TPU, 2a886c8
2022-06-11 12:45:31.336179: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (6): TPU, 2a886c8
2022-06-11 12:45:31.336185: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (7): TPU, 2a886c8
WARNING:absl:`tf.distribute.experimental.TPUStrategy` is deprecated, please use  the non experimental symbol `tf.distribute.TPUStrategy` instead.
2022-06-11 12:45:38.577297: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-06-11 12:45:38.599286: I tensorflow/compiler/jit/xla_compilation_cache.cc:478] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-06-11 12:45:38.614568: W tensorflow/compiler/tf2xla/kernels/random_ops.cc:57] Warning: Using tf.random.uniform with XLA compilation will ignore seeds; consider using tf.random.stateless_uniform instead if reproducible behavior is desired. RandomUniform
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 550, 6)]     0           []                               
                                                                                                  
 conv1d (Conv1D)                (None, 550, 64)      1216        ['input_1[0][0]']                
                                                                                                  
 concatenate (Concatenate)      (None, 550, 70)      0           ['conv1d[0][0]',                 
                                                                  'input_1[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 550, 32)      2272        ['concatenate[0][0]']            
                                                                                                  
 leaky_re_lu (LeakyReLU)        (None, 550, 32)      0           ['dense[0][0]']                  
                                                                                                  
 layer_normalization (LayerNorm  (None, 550, 32)     64          ['leaky_re_lu[0][0]']            
 alization)                                                                                       
                                                                                                  
 conv1d_1 (Conv1D)              (None, 550, 128)     20608       ['layer_normalization[0][0]']    
                                                                                                  
 concatenate_1 (Concatenate)    (None, 550, 160)     0           ['conv1d_1[0][0]',               
                                                                  'layer_normalization[0][0]']    
                                                                                                  
 dense_1 (Dense)                (None, 550, 64)      10304       ['concatenate_1[0][0]']          
                                                                                                  
 leaky_re_lu_1 (LeakyReLU)      (None, 550, 64)      0           ['dense_1[0][0]']                
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 550, 64)     128         ['leaky_re_lu_1[0][0]']          
 rmalization)                                                                                     
                                                                                                  
 conv1d_2 (Conv1D)              (None, 550, 128)     41088       ['layer_normalization_1[0][0]']  
                                                                                                  
 concatenate_2 (Concatenate)    (None, 550, 192)     0           ['conv1d_2[0][0]',               
                                                                  'layer_normalization_1[0][0]']  
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 550, 192)    384         ['concatenate_2[0][0]']          
 rmalization)                                                                                     
                                                                                                  
 dense_2 (Dense)                (None, 550, 128)     24704       ['layer_normalization_2[0][0]']  
                                                                                                  
 conv1d_3 (Conv1D)              (None, 550, 128)     82048       ['dense_2[0][0]']                
                                                                                                  
 add (Add)                      (None, 550, 128)     0           ['conv1d_3[0][0]',               
                                                                  'dense_2[0][0]']                
                                                                                                  
 conv1d_4 (Conv1D)              (None, 550, 128)     82048       ['add[0][0]']                    
                                                                                                  
 add_1 (Add)                    (None, 550, 128)     0           ['conv1d_4[0][0]',               
                                                                  'add[0][0]']                    
                                                                                                  
 conv1d_5 (Conv1D)              (None, 550, 128)     82048       ['add_1[0][0]']                  
                                                                                                  
 add_2 (Add)                    (None, 550, 128)     0           ['conv1d_5[0][0]',               
                                                                  'add_1[0][0]']                  
                                                                                                  
 conv1d_6 (Conv1D)              (None, 550, 128)     82048       ['add_2[0][0]']                  
                                                                                                  
 add_3 (Add)                    (None, 550, 128)     0           ['conv1d_6[0][0]',               
                                                                  'add_2[0][0]']                  
                                                                                                  
 conv1d_7 (Conv1D)              (None, 550, 128)     82048       ['add_3[0][0]']                  
                                                                                                  
 add_4 (Add)                    (None, 550, 128)     0           ['conv1d_7[0][0]',               
                                                                  'add_3[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 550, 32)      4128        ['add_4[0][0]']                  
                                                                                                  
 leaky_re_lu_2 (LeakyReLU)      (None, 550, 32)      0           ['dense_3[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 550, 16)      528         ['leaky_re_lu_2[0][0]']          
                                                                                                  
 leaky_re_lu_3 (LeakyReLU)      (None, 550, 16)      0           ['dense_4[0][0]']                
                                                                                                  
 tf.__operators__.getitem (Slic  (None, 6)           0           ['input_1[0][0]']                
 ingOpLambda)                                                                                     
                                                                                                  
 input_2 (InputLayer)           [(None, 2)]          0           []                               
                                                                                                  
 flatten (Flatten)              (None, 8800)         0           ['leaky_re_lu_3[0][0]']          
                                                                                                  
 reshape (Reshape)              (None, 6)            0           ['tf.__operators__.getitem[0][0]'
                                                                 ]                                
                                                                                                  
 concatenate_3 (Concatenate)    (None, 8808)         0           ['input_2[0][0]',                
                                                                  'flatten[0][0]',                
                                                                  'reshape[0][0]']                
                                                                                                  
 dense_5 (Dense)                (None, 512)          4510208     ['concatenate_3[0][0]']          
                                                                                                  
 leaky_re_lu_4 (LeakyReLU)      (None, 512)          0           ['dense_5[0][0]']                
                                                                                                  
 dense_6 (Dense)                (None, 512)          262656      ['leaky_re_lu_4[0][0]']          
                                                                                                  
 leaky_re_lu_5 (LeakyReLU)      (None, 512)          0           ['dense_6[0][0]']                
                                                                                                  
 dense_7 (Dense)                (None, 512)          262656      ['leaky_re_lu_5[0][0]']          
                                                                                                  
 leaky_re_lu_6 (LeakyReLU)      (None, 512)          0           ['dense_7[0][0]']                
                                                                                                  
 dense_8 (Dense)                (None, 512)          262656      ['leaky_re_lu_6[0][0]']          
                                                                                                  
 leaky_re_lu_7 (LeakyReLU)      (None, 512)          0           ['dense_8[0][0]']                
                                                                                                  
 dense_9 (Dense)                (None, 2)            1024        ['leaky_re_lu_7[0][0]']          
                                                                                                  
==================================================================================================
Total params: 5,814,864
Trainable params: 5,814,864
Non-trainable params: 0
__________________________________________________________________________________________________
2022-06-11 12:46:55.487119: I tensorflow/core/tpu/graph_rewrite/encapsulate_tpu_computations_pass.cc:254] Subgraph fingerprint:4427246252430814678
2022-06-11 12:46:55.508642: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:903] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node StatefulPartitionedCall.
2022-06-11 12:46:55.534615: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:903] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node StatefulPartitionedCall.
2022-06-11 12:46:55.573607: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:435] TPU host compilation cache miss: cache_key(3244867253950604470), session_name()
2022-06-11 12:46:56.718376: I tensorflow/core/tpu/kernels/tpu_compile_op_common.cc:193] Compilation of 3244867253950604470 with session name  took 1.144694719s and succeeded
2022-06-11 12:46:56.724224: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:468] TPU host compilation cache: compilation complete for cache_key(3244867253950604470), session_name(), subgraph_key(std::string(property.function_name) = "cluster_tpu_function_4427246252430814678", property.function_library_fingerprint = 4777851646682499412, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, topology.MissingChipCount() = 0, std::string(property.shapes_prefix) = "", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = "1688352644216761960")
2022-06-11 12:46:56.724258: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:534] After adding entry for key 3244867253950604470 with session_name  cache is 1 entries (4573293 bytes),  marked for eviction 0 entries (0 bytes).
2022-06-11 12:53:28.818135: I tensorflow/core/tpu/graph_rewrite/encapsulate_tpu_computations_pass.cc:254] Subgraph fingerprint:3107655730476307092
2022-06-11 12:53:28.844613: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:903] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node StatefulPartitionedCall.
2022-06-11 12:53:28.874696: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:903] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node StatefulPartitionedCall.
2022-06-11 12:53:28.921737: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:435] TPU host compilation cache miss: cache_key(1119711134580349806), session_name()
2022-06-11 12:53:29.885010: I tensorflow/core/tpu/kernels/tpu_compile_op_common.cc:193] Compilation of 1119711134580349806 with session name  took 963.181295ms and succeeded
2022-06-11 12:53:29.888301: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:468] TPU host compilation cache: compilation complete for cache_key(1119711134580349806), session_name(), subgraph_key(std::string(property.function_name) = "cluster_tpu_function_3107655730476307092", property.function_library_fingerprint = 2424330818460244959, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, topology.MissingChipCount() = 0, std::string(property.shapes_prefix) = "", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = "1688352644216761960")
2022-06-11 12:53:29.888346: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:534] After adding entry for key 1119711134580349806 with session_name  cache is 2 entries (8631376 bytes),  marked for eviction 0 entries (0 bytes).
2022-06-11 12:53:35.570738: I tensorflow/core/tpu/graph_rewrite/encapsulate_tpu_computations_pass.cc:254] Subgraph fingerprint:12645940397910630420
2022-06-11 12:53:35.802627: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:903] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node StatefulPartitionedCall.
2022-06-11 12:53:36.155793: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:903] model_pruner failed: INVALID_ARGUMENT: Graph does not contain terminal node StatefulPartitionedCall.
2022-06-11 12:53:36.597867: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:435] TPU host compilation cache miss: cache_key(9604476722533915935), session_name()
2022-06-11 12:53:42.189611: I tensorflow/core/tpu/kernels/tpu_compile_op_common.cc:193] Compilation of 9604476722533915935 with session name  took 5.591662868s and succeeded
2022-06-11 12:53:42.209410: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:468] TPU host compilation cache: compilation complete for cache_key(9604476722533915935), session_name(), subgraph_key(std::string(property.function_name) = "cluster_tpu_function_12645940397910630420", property.function_library_fingerprint = 14879583798292171109, property.mlir_module_fingerprint = 0, property.num_replicas = 8, topology.chip_bounds().x = 2, topology.chip_bounds().y = 2, topology.chip_bounds().z = 1, topology.wrap().x = false, topology.wrap().y = false, topology.wrap().z = false, topology.MissingChipCount() = 0, std::string(property.shapes_prefix) = "", property.guaranteed_constants_size = 0, embedding_partitions_fingerprint = "1688352644216761960")
2022-06-11 12:53:42.209467: I tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc:534] After adding entry for key 9604476722533915935 with session_name  cache is 3 entries (38948401 bytes),  marked for eviction 0 entries (0 bytes).
warmup...
-----------
l: 0.0
q: 0.0
reward sum -1311.707190203584
l/s -0.9999935245323094
t 67.97761917114258
-----------
training...
-----------
l: 0.3605107274153852
q: 0.3511327711120248
reward sum -310.8054875907422
l/s -0.999913284772806
t 563.8468980789185
-----------
-----------
l: 0.05668609333131555
q: 0.3963425249069721
reward sum -550.8012144406273
l/s -0.9999111821653788
t 609.2010259628296
-----------
-----------
l: 0.0032222850599433364
q: 0.5185982187489768
reward sum -1179.037366110515
l/s -0.9998916811091855
t 639.9919271469116
-----------
-----------
l: 0.001270486590409665
q: 0.7493016195821238
reward sum -1789.301329136659
l/s -0.9998950131233596
t 672.430157661438
-----------
-----------
l: 0.001133538447377375
q: 0.9001161023215218
reward sum -2307.755091842538
l/s -0.9998994873856669
t 722.1443891525269
-----------
-----------
l: 0.0012544286132919937
q: 0.9887277352940905
reward sum -2836.1588747099822
l/s -0.9998981358867272
t 766.6195631027222
-----------
-----------
l: 0.0008829387816503741
q: 1.05949898729553
reward sum -3304.090748133235
l/s -0.9998999799959992
t 823.5508441925049
-----------
-----------
l: 0.0012033460535075665
q: 1.0479397819592402
reward sum -3650.8611810373095
l/s -0.9999004380724811
t 877.6465892791748
-----------
-----------
l: 0.0008162868325598538
q: 1.0296030748378742
reward sum -3987.8508426015496
l/s -0.9999019703950593
t 957.9152822494507
-----------
-----------
l: 0.000737684885399057
q: 1.0438000114409478
reward sum -4294.536373861586
l/s -0.9999030538051381
t 1014.9066686630249
-----------
-----------
l: 0.0011533996489620163
q: 1.0614111128744188
reward sum -4574.552610417894
l/s -0.9998991223645718
t 1088.0035638809204
-----------
-----------
l: 0.0009053262118169886
q: 1.0469308865296614
reward sum -5044.831296386384
l/s -0.9998982188295166
t 1150.4554986953735
-----------
-----------
l: 0.0006137402708952471
q: 1.0268335555578683
reward sum -5526.071582015843
l/s -0.999897509480373
t 1235.047435760498
-----------
-----------
l: 0.0007958937760075106
q: 1.0138949084948827
reward sum -6033.5840843541955
l/s -0.9998967901744246
t 1317.1806573867798
-----------
-----------
l: 0.0005824237017365234
q: 1.0103832391592174
reward sum -6445.134921701107
l/s -0.9998992950654582
t 1400.571060180664
-----------
-----------
l: 0.0008514750323821634
q: 1.0097399355767371
reward sum -6765.416146174011
l/s -0.9998992646318122
t 1486.6068124771118
-----------
-----------
l: 0.0007162769721911605
q: 1.0158655686931057
reward sum -7141.018020856664
l/s -0.9999001398042741
t 1606.2517642974854
-----------
-----------
l: 0.0016748477171679222
q: 1.039830686329128
reward sum -7461.897509052895
l/s -0.9998978966714315
t 1668.9173221588135
-----------
-----------
l: 0.0007570132045577418
q: 1.0767425255818324
reward sum -7777.064021961586
l/s -0.9998882306918521
t 1743.2435750961304
-----------
-----------
l: 0.00037613434115909487
q: 1.1175768438514535
reward sum -8245.48237851683
l/s -0.9998954412379757
t 1852.1526098251343
-----------
-----------
l: 0.0006549230186553271
q: 1.1426299697273856
reward sum -8610.761776233718
l/s -0.9998977400552204
t 1978.0335664749146
-----------
-----------
l: 0.0006325298592281462
q: 1.1731696013327721
reward sum -8950.375210036791
l/s -0.9998969284683571
t 2084.8182678222656
-----------
-----------
l: 0.0008022275869843616
q: 1.214116057673177
reward sum -9359.736505276462
l/s -0.9998966194562183
t 2222.776460647583
-----------
-----------
l: 0.0005449399786675849
q: 1.2528385645621545
reward sum -9582.055441621802
l/s -0.9998972356386805
t 2321.9574213027954
-----------
-----------
l: 0.0008788037644139817
q: 1.296211842890386
reward sum -9851.470718492052
l/s -0.9998999499749875
t 2421.314573287964
-----------
-----------
l: 0.0006568402030599326
q: 1.3263485001755524
reward sum -10248.532466130828
l/s -0.9998966728662947
t 2562.385034561157
-----------
-----------
l: 0.0007247873463211862
q: 1.3652648589946887
reward sum -10491.44059235282
l/s -0.9998912097476066
t 2687.4454021453857
-----------
-----------
l: 0.0009673193108119358
q: 1.4166419801416692
reward sum -10797.496113627112
l/s -0.9998914341548149
t 2777.0368576049805
-----------
-----------
l: 0.000937897806517929
q: 1.4703339873017607
reward sum -11106.976923123393
l/s -0.9998953317981997
t 3000.7314682006836
-----------
-----------
l: 0.000622640618279798
q: 1.5246910848817625
reward sum -11459.909236698299
l/s -0.9998898920942524
t 3132.935571670532
-----------
-----------
l: 0.000562806886130154
q: 1.5630908718595018
reward sum -11833.350851915438
l/s -0.9998978966714315
t 3263.4071826934814
-----------
-----------
l: 0.0008835530746261532
q: 1.6176662877365784
reward sum -12332.422505378107
l/s -0.99989417989418
t 3387.9842281341553
-----------
-----------
l: 0.0005801874626472722
q: 1.6646409581353019
reward sum -12720.520836088057
l/s -0.9998994166163749
t 3557.8231811523438
-----------
-----------
l: 0.0008380277083272592
q: 1.7070093260897503
reward sum -13126.084266590125
l/s -0.9998968434082938
t 3728.9618492126465
-----------
-----------
l: 0.0006931934113998687
q: 1.749478594168321
reward sum -13617.546116403075
l/s -0.9998974569319115
t 3882.799243927002
-----------
-----------
l: 0.0008729560906338612
q: 1.7912612672333237
reward sum -14128.364638809804
l/s -0.9998961794019934
t 4022.3021268844604
-----------
-----------
l: 0.0009277589879974795
q: 1.8239436884383697
reward sum -14388.159728151746
l/s -0.9998947811447811
t 4074.3545055389404
-----------
-----------
l: 0.00047077721403100524
q: 1.8554711653874232
reward sum -14832.313433198424
l/s -0.9998904709748083
t 4283.780860900879
-----------
-----------
l: 0.0007300329344833482
q: 1.8844368304167833
reward sum -15305.858308982954
l/s -0.9998917514613552
t 4493.83852481842
-----------
-----------
l: 0.0012536559042237749
q: 1.9231266650286587
reward sum -15698.306775245352
l/s -0.9998872985461512
t 4535.288763046265
-----------
-----------
l: 0.0015877594220049965
q: 1.9799622036479452
reward sum -16059.25943207172
l/s -0.9998930710008554
t 4726.293158531189
-----------
-----------
l: 0.0010040077463204793
q: 2.020771086870969
reward sum -16338.488242209869
l/s -0.9998922878069797
t 4933.212637901306
-----------
-----------
l: 0.0006460405029892619
q: 2.0540041530525293
reward sum -16622.654755142008
l/s -0.9998883928571428
t 4971.805572509766
-----------
-----------
l: 0.0005493530187306094
q: 2.1003238343811415
reward sum -17143.58783067828
l/s -0.9998889752414788
t 5163.627099990845
-----------
-----------
l: 0.000943250640587182
q: 2.1380466828932176
reward sum -17453.507683900534
l/s -0.9998893805309734
t 5287.797784805298
-----------
-----------
l: 0.0005936391498035736
q: 2.1734083470526513
reward sum -17761.780654830556
l/s -0.9998900857331282
t 5435.5085372924805
-----------
-----------
l: 0.0008591775991148539
q: 2.2080703753453275
reward sum -18084.279005774977
l/s -0.9998932650229481
t 5627.594017982483
-----------
-----------
l: 0.0013998000735396831
q: 2.259381029632065
reward sum -18522.617575900545
l/s -0.9998868266183794
t 5690.775752067566
-----------
-----------
l: 0.0007041120968735684
q: 2.3095318327893266
reward sum -18929.45990846753
l/s -0.9998898678414097
t 5800.462341308594
-----------
-----------
l: 0.0005013945578916668
q: 2.3306372491987077
reward sum -19296.00210344027
l/s -0.9998859489051095
t 5952.299952507019
-----------
-----------
l: 0.0010593847335686887
q: 2.353084327457668
reward sum -19579.402743050152
l/s -0.9998867497168743
t 6125.02818107605
-----------
-----------
l: 0.0004558076745722958
q: 2.3622977473995426
reward sum -19852.9835146295
l/s -0.99989092495637
t 6242.532324790955
-----------
-----------
l: 0.000617253082764564
q: 2.379639634838352
reward sum -20189.27940029171
l/s -0.9998894661213662
t 6386.327838897705
-----------
-----------
l: 0.0007113398592277722
q: 2.3924387075327016
reward sum -20627.033655516236
l/s -0.9998889259135844
t 6559.211468696594
-----------
-----------
l: 0.0007132871002171384
q: 2.411252235675549
reward sum -20778.615329909633
l/s -0.9998900373872883
t 6653.739809989929
-----------
-----------
l: 0.00046561678838687013
q: 2.4197188750370877
